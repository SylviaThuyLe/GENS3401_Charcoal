---
title: "Anthracological Assessment of Post-Settlement Soils in Fundy Provincial Park "
date: "`r format(Sys.Date())`"
author:
- Nabiha Tasnuv^1^*
- Sydney Teresa Battist^1^*
- Thuy Thi Ngoc Le^1^*

output:
  bookdown::html_document2:
    code_folding: show
    keep_md: yes
    toc: TRUE
    toc_float: TRUE
    toc_depth: 6
    fig_caption: yes
editor_options: 
  markdown: 
    wrap: 72
---
```{css, echo=FALSE}
p.caption {
  font-size: 18px;
}
```

# **ACKNOWLEDGEMENTS** {-}
Ben Phiplip
Elizabeth Stregger (data coding)
Oher group member for dendro 

# **MATERIALS & METHODS** 
## Set Chunk Options
```{r setup, include=FALSE}
knitr::opts_chunk$set(warning = FALSE, error = FALSE, message = FALSE)
knitr::opts_chunk$set(fig.path='Figs/')
```

## Load Packages
```{r packages, include = FALSE}
library(tidyverse) #core packages from Tidyverse
library(googledrive) #access to Google Drive
library(googlesheets4) #access to Google Sheets
library(lubridate) #tidyverse handling dates & times
library(knitr) #make table
library(vegan) #shannon diversity calculation
```

## Connect to Google Account
```{r connect_google}
# Deauthorize to access public sheets
gs4_deauth()

#URL of the Google Sheet so that it is available to anyone
googlesheet_url <- "https://docs.google.com/spreadsheets/d/1u14lKzqxOS3QofUmpfmVJ3RpYHt1jMNrFTxg_J5v4Qc/edit?usp=sharing"
```


## Accessing Data From Google Sheets
```{r accessing_sheets}
Diversity <- read_sheet(googlesheet_url, sheet = "Diversity")
Meter <- read_sheet(googlesheet_url, sheet = "Meter_Info")
ID <- read_sheet(googlesheet_url, sheet = "Tree_ID")
```


## Data Dictionary 
```{r data_dictionary}
DataDictionary <- read_sheet(googlesheet_url, sheet = "Data_dictionary")
kable(DataDictionary)
```



# **RESULTS**
## Diversity Calculation by Shannon Diversity Index
```{r shannon_diversity}
data(Diversity)
H <- diversity(Diversity)
simp <- diversity(BCI, "simpson")
invsimp <- diversity(BCI, "inv")
## Unbiased Simpson
unbias.simp <- simpson.unb(BCI)
## Fisher alpha
alpha <- fisher.alpha(BCI)
## Plot all
pairs(cbind(H, simp, invsimp, unbias.simp, alpha), pch="+", col="blue")
## Species richness (S) and Pielou's evenness (J):
S <- specnumber(BCI) ## rowSums(BCI > 0) does the same...
J <- H/log(S)
## beta diversity defined as gamma/alpha - 1:
## alpha is the average no. of species in a group, and gamma is the
## total number of species in the group
(alpha <- with(BCI.env, tapply(specnumber(BCI), Habitat, mean)))
(gamma <- with(BCI.env, specnumber(BCI, Habitat)))
gamma/alpha - 1
## similar calculations with Shannon diversity
(alpha <- with(BCI.env, tapply(diversity(BCI), Habitat, mean))) # average
(gamma <- with(BCI.env, diversity(BCI, groups=Habitat))) # pooled
## additive beta diversity based on Shannon indexs
gamma-alpha
#########################
diversity(Diversity, shannon = "shannon", groups, equalize.groups = FALSE,
   MARGIN = 1, base = exp(1))
simpson.unb(Diversity, inverse = FALSE)
fisher.alpha(Diversity, MARGIN = 1, ...)
specnumber(Diversity, groups, MARGIN = 1)
```

## Histogram 
```{r}
# Combine two data frames
PhysChem_combined <- bind_rows(
  PhysChemP %>% mutate(Source = "Pellet"),
  PhysChemL %>% mutate(Source = "Liquid")
)

# Plot the data
  ## scale_fill_brewer(palette = "______"): set color for the graph
  ## position = "dodge" : put the columns side-by-side
  ## binwidth = ____ : changing size of the columns
ggplot(PhysChem_combined) +
  geom_histogram(aes(x = Colony_Type, fill = Source), position = "dodge", binwidth = 1) +
  facet_grid(rows = vars(Treat_label)) +
  theme_bw() +
  scale_fill_brewer(palette = "Set2") +
  labs(
    title = "Comparison of Colony Types Between Liquid and Pellet Vermicast Outputs",
    x = "Colony_Type",
    y = "Count",
    fill = "Legend"
  )
```







